"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5540],{5540:function(Y,A,t){t.r(A),t.d(A,{Router:function(){return nt}});var e=t(2784),D=t(39857),y=t(73557),u=t(30705),h=t(80236),x=t(73495),O=t(78698),U=t(77277),k=t(61837),Ee=t(41156),fe=t(88188),ge=t(75650),he=t(56563),Z=t(23054),W=t(34520),z=t(12053),ee=t(30411),B=t(79692),ye=t(60364),Ce=t(79784),Te=t(50758),b=t(12231),j=t(86136),G=t(49378),N=t(95544),te=t(27556),ne=t(42494),ae=t(56939),le=t(73698),oe=t(94339),re=t(32552),se=t(24579),xe=t(67358),Ze=t(19126),Se=t.n(Ze),ie=t(51967),Ae=t(49166),Fe=t(93269),Re=t(8198),Pe=t(15026),Ie=t(43054),Oe=t(77120),ze=t(42123),ce=t(87685),De=t(2552),K=t(10921),Le=t(39362),F=t(29181),Be=t(64279),be=t(48760);const Ne=(0,B.Z)(()=>({button:{color:({fontColor:n})=>n}})),Me=n=>{const{cancelEnabled:a,logsVisible:o,buttonBarVisible:i,onStartOver:r,onToggleLogs:v,onToggleButtonBar:s,taskId:f}=n,{getPageTheme:c}=(0,ye.Z)(),m=c({themeId:"website"}),E=Ne({fontColor:m.fontColor}),p=(0,u.h_)(z.lc),[T,l]=(0,e.useState)(),[{status:C},{execute:S}]=(0,ie.r)(async()=>{f&&await p.cancelTask(f)});return e.createElement(e.Fragment,null,e.createElement(k.Z,{"aria-label":"more","aria-controls":"long-menu","aria-haspopup":"true",onClick:d=>{l(d.currentTarget)},"data-testid":"menu-button",className:E.button},e.createElement(Ie.Z,null)),e.createElement(Ce.ZP,{open:Boolean(T),onClose:()=>l(void 0),anchorEl:T,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},e.createElement(Te.Z,null,e.createElement(b.Z,{onClick:()=>v==null?void 0:v(!o)},e.createElement(j.Z,null,e.createElement(Re.Z,{fontSize:"small"})),e.createElement(G.Z,{primary:o?"Hide Logs":"Show Logs"})),e.createElement(b.Z,{onClick:()=>s==null?void 0:s(!i)},e.createElement(j.Z,null,e.createElement(Pe.Z,{fontSize:"small"})),e.createElement(G.Z,{primary:i?"Hide Button Bar":"Show Button Bar"})),e.createElement(b.Z,{onClick:r},e.createElement(j.Z,null,e.createElement(Fe.Z,{fontSize:"small"})),e.createElement(G.Z,{primary:"Start Over"})),e.createElement(b.Z,{onClick:S,disabled:!a||C!=="not-executed","data-testid":"cancel-task"},e.createElement(j.Z,null,e.createElement(Ae.Z,{fontSize:"small"})),e.createElement(G.Z,{primary:"Cancel"})))))},We=(0,B.Z)(n=>({contentWrapper:{display:"flex",flexDirection:"column"},buttonBar:{display:"flex",flexDirection:"row",justifyContent:"right"},cancelButton:{marginRight:n.spacing(1)}})),Ve=n=>{var a,o,i,r,v,s,f,c;const{taskId:m}=(0,y.UO)(),E=(0,u.tg)(Z.k),p=(0,y.s0)(),T=(0,u.h_)(z.lc),l=(0,z.WQ)(m),C=We(),S=(0,e.useMemo)(()=>{var I,w;return(w=(I=l.task)==null?void 0:I.spec.steps.map($=>{var H;return{...$,...(H=l==null?void 0:l.steps)==null?void 0:H[$.id]}}))!=null?w:[]},[l]),[d,g]=(0,e.useState)(!1),[R,P]=(0,e.useState)(!0);(0,e.useEffect)(()=>{l.error&&g(!0)},[l.error]),(0,e.useEffect)(()=>{l.completed&&!l.error&&P(!1)},[l.error,l.completed]);const M=(0,e.useMemo)(()=>{for(let I=S.length-1;I>=0;I--)if(S[I].status!=="open")return I;return 0},[S]),L=(0,e.useCallback)(()=>{var I,w,$,H,de,ue;const{namespace:ve,name:pe}=(H=($=(w=(I=l.task)==null?void 0:I.spec.templateInfo)==null?void 0:w.entity)==null?void 0:$.metadata)!=null?H:{},at=(ue=(de=l.task)==null?void 0:de.spec.parameters)!=null?ue:{};!ve||!pe||p({pathname:E({namespace:ve,templateName:pe}),search:`?${Se().stringify({formData:JSON.stringify(at)})}`})},[p,(a=l.task)==null?void 0:a.spec.parameters,(r=(i=(o=l.task)==null?void 0:o.spec.templateInfo)==null?void 0:i.entity)==null?void 0:r.metadata,E]),[{status:Q},{execute:X}]=(0,ie.r)(async()=>{m&&await T.cancelTask(m)}),q=(v=n.TemplateOutputsComponent)!=null?v:O.Iy,me=(c=(f=(s=l.task)==null?void 0:s.spec.templateInfo)==null?void 0:f.entity)==null?void 0:c.metadata.name,_=!(l.cancelled||l.completed);return e.createElement(h.T3,{themeId:"website"},e.createElement(h.h4,{pageTitleOverride:`Run of ${me}`,title:e.createElement("div",null,"Run of ",e.createElement("code",null,me)),subtitle:`Task ${m}`},e.createElement(Me,{cancelEnabled:_,logsVisible:d,buttonBarVisible:R,onStartOver:L,onToggleLogs:g,onToggleButtonBar:P,taskId:m})),e.createElement(h.VY,{className:C.contentWrapper},l.error?e.createElement(N.Z,{paddingBottom:2},e.createElement(h.yu,{error:l.error,title:l.error.message})):null,e.createElement(N.Z,{paddingBottom:2},e.createElement(O.Lp,{steps:S,activeStep:M,isComplete:l.completed,isError:Boolean(l.error)})),e.createElement(q,{output:l.output}),R?e.createElement(N.Z,{paddingBottom:2},e.createElement(te.Z,null,e.createElement(N.Z,{padding:2},e.createElement("div",{className:C.buttonBar},e.createElement(U.Z,{className:C.cancelButton,disabled:!_||Q!=="not-executed",onClick:X,"data-testid":"cancel-button"},"Cancel"),e.createElement(U.Z,{variant:"contained",color:"primary",disabled:_,onClick:L},"Start Over"))))):null,d?e.createElement(N.Z,{paddingBottom:2,height:"100%"},e.createElement(te.Z,{style:{height:"100%"}},e.createElement(N.Z,{padding:2,height:"100%"},e.createElement(O.v9,{logs:l.stepLogs})))):null))},we=(0,B.Z)({containerWrapper:{position:"relative",width:"100%",height:"100%"},container:{position:"absolute",top:0,bottom:0,left:0,right:0,overflow:"auto"}});class $e extends e.Component{constructor(){super(...arguments),this.state={shouldRender:!0}}componentDidUpdate(a){a.invalidator!==this.props.invalidator&&this.setState({shouldRender:!0})}componentDidCatch(a){this.props.setErrorText(a.message),this.setState({shouldRender:!1})}render(){return this.state.shouldRender?this.props.children:null}}function J(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function V(n){const{content:a,contentIsSpec:o,onDryRun:i,setErrorText:r,fieldExtensions:v=[],layouts:s=[]}=n,f=we(),c=(0,u.I_)(),[m,E]=(0,e.useState)();return(0,be.Z)(()=>{try{if(!a){E(void 0);return}const p=K.ZP.parse(a);if(!J(p)){E(void 0);return}let T=p;if(!o){if(!(String(p.kind).toLocaleLowerCase("en-US")==="template")){E(void 0);return}T=J(p.spec)?p.spec:{}}const{parameters:l}=T;if(!Array.isArray(l)){r("Template parameters must be an array"),E(void 0);return}r(),E(l.flatMap(C=>J(C)?[{title:String(C.title),schema:C}]:[]))}catch(p){r(p.message)}},250,[o,a,c]),m?e.createElement("div",{className:f.containerWrapper},e.createElement("div",{className:f.container},e.createElement($e,{invalidator:m,setErrorText:r},e.createElement(O.vF,{manifest:{steps:m,title:"Template Editor"},extensions:v,onCreate:async p=>{await(i==null?void 0:i(p))},layouts:s,components:{createButtonText:i&&"Try It"}})))):null}function He(n){const{setErrorText:a,fieldExtensions:o=[],layouts:i}=n,r=(0,F.u)(),v=(0,F.a)(),{selectedFile:s}=v,f=async m=>{if(s)try{await r.execute({templateContent:s.content,values:m,files:v.files}),a()}catch(E){throw a(String(E.cause||E)),E}},c=s&&s.path.match(/\.ya?ml$/)?s.content:void 0;return e.createElement(V,{onDryRun:f,fieldExtensions:o,setErrorText:a,content:c,layouts:i})}V.DirectoryEditorDryRun=He;const Ue=(0,B.Z)(n=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "fieldForm preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:n.spacing(1)},fieldForm:{gridArea:"fieldForm"},preview:{gridArea:"preview"}})),ke=({customFieldExtensions:n=[],onClose:a})=>{var o,i;const r=Ue(),v=n.filter(d=>!!d.schema),[s,f]=(0,e.useState)(v[0]),[c,m]=(0,e.useState)({}),[E,p]=(0,e.useState)(Date.now()),T=(0,e.useMemo)(()=>{var d,g;return K.ZP.stringify({parameters:[{title:`${s.name} Example`,properties:{[s.name]:{type:(g=(d=s.schema)==null?void 0:d.returnValue)==null?void 0:g.type,"ui:field":s.name,"ui:options":c}}}]})},[c,s]),l=(0,e.useMemo)(()=>Object.fromEntries(n.map(({name:d,component:g})=>[d,g])),[n]),C=(0,e.useCallback)(d=>{f(d),m({})},[m,f]),S=(0,e.useCallback)(d=>{m(d),p(Date.now())},[m,p]);return e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(ne.Z,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(ae.Z,{id:"select-field-label"},"Choose Custom Field Extension"),e.createElement(le.Z,{value:s,label:"Choose Custom Field Extension",labelId:"select-field-label",onChange:d=>C(d.target.value)},v.map((d,g)=>e.createElement(b.Z,{key:g,value:d},d.name)))),e.createElement(k.Z,{size:"medium",onClick:a,"aria-label":"Close"},e.createElement(ce.Z,null))),e.createElement("div",{className:r.fieldForm},e.createElement(oe.Z,null,e.createElement(re.Z,{title:"Field Options"}),e.createElement(se.Z,null,e.createElement(O.l0,{showErrorList:!1,fields:{...l},noHtml5Validate:!0,formData:c,formContext:{fieldFormState:c},onSubmit:d=>S(d.formData),validator:Le.Z,schema:((o=s.schema)==null?void 0:o.uiOptions)||{}},e.createElement(U.Z,{variant:"contained",color:"primary",type:"submit",disabled:!((i=s.schema)!=null&&i.uiOptions)},"Apply"))))),e.createElement("div",{className:r.preview},e.createElement(oe.Z,null,e.createElement(re.Z,{title:"Example Template Spec"}),e.createElement(se.Z,null,e.createElement(De.ZP,{readOnly:!0,theme:"dark",height:"100%",extensions:[Oe.il.define(ze.r)],value:T}))),e.createElement(V,{key:E,content:T,contentIsSpec:!0,fieldExtensions:n,setErrorText:()=>null})))},je=(0,B.Z)({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "browser editor preview"
      "results results results"
    `,gridTemplateColumns:"1fr 3fr 2fr",gridTemplateRows:"1fr auto"},browser:{gridArea:"browser",overflow:"auto"},editor:{gridArea:"editor",overflow:"auto"},preview:{gridArea:"preview",overflow:"auto"},results:{gridArea:"results"}}),Ge=n=>{const a=je(),[o,i]=(0,e.useState)();return e.createElement(F.D,{directory:n.directory},e.createElement(F.b,null,e.createElement("main",{className:a.root},e.createElement("section",{className:a.browser},e.createElement(F.T,{onClose:n.onClose})),e.createElement("section",{className:a.editor},e.createElement(F.c.DirectoryEditor,{errorText:o})),e.createElement("section",{className:a.preview},e.createElement(V.DirectoryEditorDryRun,{setErrorText:i,fieldExtensions:n.fieldExtensions,layouts:n.layouts})),e.createElement("section",{className:a.results},e.createElement(F.d,null)))))},Ye=`# Edit the template parameters below to see how they will render in the scaffolder form UI
parameters:
  - title: Fill in some steps
    required:
      - name
    properties:
      name:
        title: Name
        type: string
        description: Unique name of the component
      owner:
        title: Owner
        type: string
        description: Owner of the component
        ui:field: OwnerPicker
        ui:options:
          catalogFilter:
            kind: Group
  - title: Choose a location
    required:
      - repoUrl
    properties:
      repoUrl:
        title: Repository Location
        type: string
        ui:field: RepoUrlPicker
        ui:options:
          allowedHosts:
            - github.com
steps:
  - id: fetch-base
    name: Fetch Base
    action: fetch:template
    input:
      url: ./template
      values:
        name: \${{parameters.name}}
`,Ke=(0,B.Z)(n=>({root:{gridArea:"pageContent",display:"grid",gridTemplateAreas:`
      "controls controls"
      "textArea preview"
    `,gridTemplateRows:"auto 1fr",gridTemplateColumns:"1fr 1fr"},controls:{gridArea:"controls",display:"flex",flexFlow:"row nowrap",alignItems:"center",margin:n.spacing(1)},textArea:{gridArea:"textArea"},preview:{gridArea:"preview"}})),Je=({defaultPreviewTemplate:n=Ye,customFieldExtensions:a=[],onClose:o,layouts:i=[]})=>{const r=Ke(),v=(0,u.h_)(u.$v),s=(0,u.h_)(x.Ah),[f,c]=(0,e.useState)(""),[m,E]=(0,e.useState)(),[p,T]=(0,e.useState)([]),[l,C]=(0,e.useState)(n),{loading:S}=(0,Be.default)(()=>s.getEntities({filter:{kind:"template"},fields:["kind","metadata.namespace","metadata.name","metadata.title","spec.parameters","spec.steps","spec.output"]}).then(({items:g})=>T(g.map(R=>{var P;return{label:(P=R.metadata.title)!=null?P:(0,x.$3)(R,{defaultKind:"template"}),value:R}}))).catch(g=>v.post({message:`Error loading exisiting templates: ${g.message}`,severity:"error"})),[s]),d=(0,e.useCallback)(g=>{c(g),C(K.ZP.stringify(g.spec))},[C]);return e.createElement(e.Fragment,null,S&&e.createElement(xe.Z,null),e.createElement("main",{className:r.root},e.createElement("div",{className:r.controls},e.createElement(ne.Z,{variant:"outlined",size:"small",fullWidth:!0},e.createElement(ae.Z,{id:"select-template-label"},"Load Existing Template"),e.createElement(le.Z,{value:f,label:"Load Existing Template",labelId:"select-template-label",onChange:g=>d(g.target.value)},p.map((g,R)=>e.createElement(b.Z,{key:R,value:g.value},g.label)))),e.createElement(k.Z,{size:"medium",onClick:o},e.createElement(ce.Z,null))),e.createElement("div",{className:r.textArea},e.createElement(F.c,{content:l,onUpdate:C,errorText:m})),e.createElement("div",{className:r.preview},e.createElement(V,{content:l,contentIsSpec:!0,fieldExtensions:a,setErrorText:E,layouts:i}))))};var lt=t(49462),ot=t(32272),rt=t(82394),st=t(88285),it=t(68111),ct=t(72779),mt=t(26228),dt=t(75951);const Qe=n=>{const{title:a,to:o}=n,{allowed:i}=(0,he.gI)({permission:ge.x7}),r=(0,Ee.Z)(v=>v.breakpoints.down("xs"));return!o||!i?null:r?e.createElement(k.Z,{component:D.rU,color:"primary",title:a,size:"small",to:o},e.createElement(fe.Z,null)):e.createElement(U.Z,{component:D.rU,variant:"contained",color:"primary",to:o},a)},Xe={title:"Templates",filter:()=>!0},qe=n=>[...n,{title:"Other Templates",filter:a=>![...n].some(({filter:o})=>o(a))}],_e=n=>{var a,o,i;const r=(0,u.tg)(Z.t),{TemplateCardComponent:v,groups:s=[],templateFilter:f}=n,c=(0,y.s0)(),m=(0,u.tg)(Z.o),E=(0,u.tg)(Z.p),p=(0,u.tg)(Z.q),T=(0,u.tg)(Z.v),l=(0,u.tg)(Z.k),C=(0,u.qD)(),S=s.length?qe(s):[Xe],d={onEditorClicked:((a=n==null?void 0:n.contextMenu)==null?void 0:a.editor)!==!1?()=>c(m()):void 0,onActionsClicked:((o=n==null?void 0:n.contextMenu)==null?void 0:o.actions)!==!1?()=>c(E()):void 0,onTasksClicked:((i=n==null?void 0:n.contextMenu)==null?void 0:i.tasks)!==!1?()=>c(p()):void 0},g=(0,e.useCallback)(P=>{var M,L;const{kind:Q,namespace:X,name:q}=(0,W.of)((0,W.eE)(P));return(M=P.metadata.annotations)!=null&&M["backstage.io/techdocs-ref"]&&T?[{icon:(L=C.getSystemIcon("docs"))!=null?L:h.zG,text:"View TechDocs",url:T({kind:Q,namespace:X,name:q})}]:[]},[C,T]),R=(0,e.useCallback)(P=>{const{namespace:M,name:L}=(0,W.of)((0,W.eE)(P));c(l({namespace:M,templateName:L}))},[c,l]);return e.createElement(x.UO,null,e.createElement(h.T3,{themeId:"website"},e.createElement(h.h4,{pageTitleOverride:"Create a new component",title:"Create a new component",subtitle:"Create new software components using standard templates in your organization"},e.createElement(O.zP,{...d})),e.createElement(h.VY,null,e.createElement(h.yW,{title:"Available Templates"},e.createElement(Qe,{title:"Register Existing Component",to:r&&r()}),e.createElement(h.qt,null,"Create new software components using standard templates. Different templates create different kinds of components (services, websites, documentation, ...).")),e.createElement(x._i,null,e.createElement(x._i.Filters,null,e.createElement(x.nN,null),e.createElement(x.tW,{initialFilter:"template",hidden:!0}),e.createElement(x.EW,{initialFilter:"all",availableFilters:["all","starred"]}),e.createElement(O._G,null),e.createElement(x.xE,null)),e.createElement(x._i.Content,null,e.createElement(O.ow,{groups:S,templateFilter:f,TemplateCardComponent:v,onTemplateSelected:R,additionalLinksForEntity:g}))))))},et=n=>{const a=(0,u.tg)(Z.r),o=(0,u.tg)(Z.u),{secrets:i}=(0,z.TD)(),r=(0,u.h_)(z.lc),v=(0,y.s0)(),{templateName:s,namespace:f}=(0,u.Oi)(Z.k),c=(0,W.eE)({kind:"Template",namespace:f,name:s}),m=async p=>{const{taskId:T}=await r.scaffold({templateRef:c,values:p,secrets:i});v(o({taskId:T}))},E=()=>e.createElement(y.Fg,{to:a()});return e.createElement(u.fC,{attributes:{entityRef:c}},e.createElement(h.T3,{themeId:"website"},e.createElement(h.h4,{pageTitleOverride:"Create a new component",title:"Create a new component",subtitle:"Create new software components using standard templates in your organization"}),e.createElement(O.h4,{namespace:f,templateName:s,onCreate:m,onError:E,extensions:n.customFieldExtensions,FormProps:n.FormProps,layouts:n.layouts})))};function tt(n){const[a,o]=(0,e.useState)();let i=null;return(a==null?void 0:a.type)==="local"?i=e.createElement(Ge,{directory:a.directory,fieldExtensions:n.customFieldExtensions,onClose:()=>o(void 0),layouts:n.layouts}):(a==null?void 0:a.type)==="form"?i=e.createElement(Je,{defaultPreviewTemplate:n.defaultPreviewTemplate,customFieldExtensions:n.customFieldExtensions,onClose:()=>o(void 0),layouts:n.layouts}):(a==null?void 0:a.type)==="field-explorer"?i=e.createElement(ke,{customFieldExtensions:n.customFieldExtensions,onClose:()=>o(void 0)}):i=e.createElement(h.VY,null,e.createElement(F.e,{onSelect:r=>{r==="local"?F.W.requestDirectoryAccess().then(v=>o({type:"local",directory:v})).catch(()=>{}):r==="form"?o({type:"form"}):r==="field-explorer"&&o({type:"field-explorer"})}})),e.createElement(h.T3,{themeId:"home"},e.createElement(h.h4,{title:"Template Editor",subtitle:"Edit, preview, and try out templates and template forms"}),i)}const nt=n=>{const{components:{TemplateCardComponent:a,TemplateOutputsComponent:o,TaskPageComponent:i=Ve,TemplateListPageComponent:r=_e,TemplateWizardPageComponent:v=et}={}}=n,s=(0,y.pC)()||n.children,f=(0,z.PT)(s),c=[...f,...ee.D.filter(({name:E})=>!f.some(p=>p.name===E))],m=(0,z.zS)(s);return e.createElement(y.Z5,null,e.createElement(y.AW,{path:"/",element:e.createElement(r,{TemplateCardComponent:a,contextMenu:n.contextMenu,groups:n.groups,templateFilter:n.templateFilter})}),e.createElement(y.AW,{path:Z.k.path,element:e.createElement(z.A3,null,e.createElement(v,{customFieldExtensions:c,layouts:m,FormProps:n.FormProps}))}),e.createElement(y.AW,{path:Z.u.path,element:e.createElement(i,{TemplateOutputsComponent:o})}),e.createElement(y.AW,{path:Z.o.path,element:e.createElement(z.A3,null,e.createElement(tt,{customFieldExtensions:c,layouts:m}))}),e.createElement(y.AW,{path:Z.p.path,element:e.createElement(F.A,null)}),e.createElement(y.AW,{path:Z.q.path,element:e.createElement(ee.L,null)}),e.createElement(y.AW,{path:"*",element:e.createElement(h.mf,{status:"404",statusMessage:"Page not found"})}))}},15026:function(Y,A,t){var e,D=t(71600),y=t(34590);e={value:!0},A.Z=void 0;var u=y(t(2784)),h=D(t(50175)),x=(0,h.default)(u.createElement("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"ControlPoint");A.Z=x},93269:function(Y,A,t){var e,D=t(71600),y=t(34590);e={value:!0},A.Z=void 0;var u=y(t(2784)),h=D(t(50175)),x=(0,h.default)(u.createElement("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"}),"Repeat");A.Z=x},8198:function(Y,A,t){var e,D=t(71600),y=t(34590);e={value:!0},A.Z=void 0;var u=y(t(2784)),h=D(t(50175)),x=(0,h.default)(u.createElement("path",{d:"M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z"}),"Toc");A.Z=x}}]);})();

//# sourceMappingURL=5540.1b7fd2bb.chunk.js.map